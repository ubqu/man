–î–∞, —Ä–æ–≤–Ω–æ –æ–Ω –∏ –ª–æ–º–∞–µ—Ç —Ç–µ–±–µ `Audit passed` üôÇ

### 1. –ß—Ç–æ —ç—Ç–æ –∑–∞ —Å—Ç—Ä–∞–Ω–Ω—ã–π —Ñ–∞–π–ª `.IMG_0035.HEIC`

–¢–æ, —á—Ç–æ —Ç—ã —É–≤–∏–¥–µ–ª –≤–Ω—É—Ç—Ä–∏:

```text
Mac OS X         2??ATTR??&?com.apple.lastuseddate#PS?com.apple.quarantine¬Ç?h?>$0082;68f382c3;...
```

‚Äî —ç—Ç–æ **–Ω–µ —Ñ–æ—Ç–æ**, –∞ –∫—É—Å–æ–∫ *–º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö macOS*, –∫–æ—Ç–æ—Ä—ã–π –æ–±—ã—á–Ω–æ –∂–∏–≤—ë—Ç –≤:

* **extended attributes (xattr)** —Ñ–∞–π–ª–∞ `IMG_0035.HEIC`, –∏–ª–∏
* –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–æ–º —Ñ–∞–π–ª–µ **—Ñ–æ—Ä–º–∞—Ç–∞ AppleDouble** (`._IMG_0035.HEIC`) –Ω–∞ —Ñ–∞–π–ª–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö, –≥–¥–µ ¬´—Ä–æ–¥–Ω—ã–µ¬ª –º–∞–∫–æ–≤—Å–∫–∏–µ xattr/—Ä–µ—Å—É—Ä—Å–Ω—ã–µ —Ñ–æ—Ä–∫–∏ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è.

–í–Ω—É—Ç—Ä–∏ —Ç–∞–∫–∏—Ö AppleDouble-—Ñ–∞–π–ª–æ–≤ –ø–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞ –≤–∏–¥–Ω—ã —Å—Ç—Ä–æ–∫–∏:

* `Mac OS X`
* `ATTR`
* `com.apple.lastuseddate#PS`
* `com.apple.quarantine`
* –∏–Ω–æ–≥–¥–∞ `This resource fork intentionally left blank`

–ü—Ä–∏–º–µ—Ä—ã —Ä–æ–≤–Ω–æ —Ç–∞–∫–æ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –µ—Å—Ç—å –≤ –±–∞–≥-—Ä–µ–ø–æ—Ä—Ç–∞—Ö –∏ –±–ª–æ–≥–∞—Ö: –ª—é–¥–∏ –æ—Ç–∫—Ä—ã–≤–∞—é—Ç —Ñ–∞–π–ª—ã `._DSCFxxxx.JPG` –∏–ª–∏ `._filename` –∏ –≤–∏–¥—è—Ç —Ç–æ—Ç –∂–µ –Ω–∞–±–æ—Ä —Å—Ç—Ä–æ–∫.

–£ —Ç–µ–±—è –ø–æ—á–µ–º—É-—Ç–æ –∏–º—è `.IMG_0035.HEIC` –±–µ–∑ –ø–æ–¥—á—ë—Ä–∫–∏–≤–∞–Ω–∏—è, –Ω–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ ‚Äî **—Ç–∏–ø–∏—á–Ω—ã–π AppleDouble/xattr-–º—É—Å–æ—Ä**, –∞ –Ω–µ HEIC-—Ñ–æ—Ç–æ.

### 2. –ü–æ—á–µ–º—É hashdeep –≥–æ–≤–æ—Ä–∏—Ç `Audit failed`

–ú–∞–Ω–∏—Ñ–µ—Å—Ç —Ç—ã —Å–¥–µ–ª–∞–ª –ø–æ ¬´—ç—Ç–∞–ª–æ–Ω–Ω–æ–º—É¬ª –¥–∏—Å–∫—É (ZFS). –¢–∞–º:

* –µ—Å—Ç—å —Ñ–∞–π–ª—ã —Ç–∏–ø–∞ `202407/IMG_0035.HEIC`,
* **–Ω–µ—Ç** —Ñ–∞–π–ª–∞ `202407/.IMG_0035.HEIC`.

–ù–∞ –¥–∏—Å–∫–µ ARCH20TB –∫–∞—Ç–∞–ª–æ–≥ `202407` —Å–æ–¥–µ—Ä–∂–∏—Ç **–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª** `.IMG_0035.HEIC`, –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–µ—Ç –≤ –º–∞–Ω–∏—Ñ–µ—Å—Ç–µ.

–î–ª—è hashdeep —ç—Ç–æ –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫:

* ¬´–≤—Å–µ —Ñ–∞–π–ª—ã –∏–∑ –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞ –Ω–∞ –º–µ—Å—Ç–µ –∏ —Å–æ–≤–ø–∞–¥–∞—é—Ç –ø–æ —Ö—ç—à—É¬ª ‚úÖ
* ¬´–Ω–æ —è –Ω–∞—à—ë–ª **–Ω–æ–≤—ã–π** —Ñ–∞–π–ª, –∫–æ—Ç–æ—Ä–æ–≥–æ –≤ –º–∞–Ω–∏—Ñ–µ—Å—Ç–µ –Ω–µ –±—ã–ª–æ¬ª ‚ùå ‚Üí **Audit failed**.

–¢—ã —É–∂–µ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª —ç—Ç–æ `diff`-–æ–º, —Ç–∞–∫ —á—Ç–æ –∫–∞—Ä—Ç–∏–Ω–∞ –ª–æ–≥–∏—á–Ω–∞—è.

–ï—Å–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å –±–æ–ª—Ç–ª–∏–≤–æ—Å—Ç—å—é:

```bash
hashdeep -vv -k 202407.sha256.manifest -r -l 202407
```

–≤ –ª–æ–≥–µ –±—É–¥—É—Ç —Å—Ç—Ä–æ–∫–∏ –Ω–∞–ø–æ–¥–æ–±–∏–µ:

```text
new,0,0,202407/.IMG_0035.HEIC
```

‚Äî —ç—Ç–æ –∫–∞–∫ —Ä–∞–∑ –∏ –µ—Å—Ç—å –ø—Ä–∏—á–∏–Ω–∞ `Audit failed`.

### 3. –û—Ç–∫—É–¥–∞ –æ–Ω –≤–∑—è–ª—Å—è –∏–º–µ–Ω–Ω–æ –Ω–∞ ARCH20TB

–°—Ü–µ–Ω–∞—Ä–∏–π –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫–æ–π:

1. macOS –≤–∏–¥–∏—Ç –≤–Ω–µ—à–Ω–∏–π –¥–∏—Å–∫ / –§–°, –≥–¥–µ –µ—ë xattr/—Ä–µ—Å—É—Ä—Å–Ω—ã–µ —Ñ–æ—Ä–∫–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –Ω–µ ¬´—Ä–æ–¥–Ω—ã–º¬ª —Å–ø–æ—Å–æ–±–æ–º.
2. –ß—Ç–æ–±—ã –Ω–µ –ø–æ—Ç–µ—Ä—è—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (`com.apple.quarantine`, `com.apple.lastuseddate#PS` –∏ –ø—Ä–æ—á–∏–µ), —Å–∏—Å—Ç–µ–º–∞ –ø–∏—à–µ—Ç –∏—Ö –≤ **–æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª AppleDouble**, –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏ `._IMG_0035.HEIC`.
3. –ü–æ –∫–∞–∫–æ–π-—Ç–æ –ø—Ä–∏—á–∏–Ω–µ (–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ, –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ, –±–∞–≥, —Ä—É—á–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è) —ç—Ç–æ—Ç —Ñ–∞–π–ª –æ–∫–∞–∑–∞–ª—Å—è —Å –∏–º–µ–Ω–µ–º `.IMG_0035.HEIC`, –Ω–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –æ—Å—Ç–∞–ª–æ—Å—å —Ç–µ–º –∂–µ.

–ù–∞ ZFS-–¥–∏—Å–∫–µ:

* ZFS –Ω–æ—Ä–º–∞–ª—å–Ω–æ —Ö—Ä–∞–Ω–∏—Ç xattr, –ø–æ—ç—Ç–æ–º—É –º–∞–∫—É **–Ω–µ –Ω—É–∂–Ω–æ** —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ç–∞–∫–∏–µ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã ‚Äî –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∂–∏–≤—É—Ç –≤–Ω—É—Ç—Ä–∏ —Ñ–∞–π–ª–∞ `IMG_0035.HEIC` –∏ ¬´—Å–Ω–∞—Ä—É–∂–∏¬ª –Ω–µ –≤–∏–¥–Ω—ã.

–û—Ç—Å—é–¥–∞ —Ä–∞–∑–Ω–∏—Ü–∞: –Ω–∞ –æ–¥–Ω–æ–º –¥–∏—Å–∫–µ –µ—Å—Ç—å —ç—Ç–æ—Ç –ª–∏—à–Ω–∏–π ¬´–º–µ—Ç–∞–¥–∞–Ω–Ω—ã–π¬ª —Ñ–∞–π–ª, –Ω–∞ –¥—Ä—É–≥–æ–º ‚Äî –Ω–µ—Ç.

### 4. –û–ø–∞—Å–µ–Ω –ª–∏ —Ñ–∞–π–ª `.IMG_0035.HEIC` –∏ –º–æ–∂–Ω–æ –ª–∏ –µ–≥–æ —É–¥–∞–ª–∏—Ç—å

–î–ª—è **—Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ —Ñ–æ—Ç–æ–∞—Ä—Ö–∏–≤–∞** ‚Äî –Ω–µ—Ç, –æ–Ω –Ω–µ –Ω—É–∂–µ–Ω:

* —ç—Ç–æ –Ω–µ –∫–∞—Ä—Ç–∏–Ω–∫–∞;
* —ç—Ç–æ –∫–æ–ø–∏—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö (quarantine, last used date, –æ—Ç–∫—É–¥–∞ —Å–∫–∞—á–∞–Ω –∏ —Ç.–ø.);
* —Ç–∞–∫–∏–µ —Ñ–∞–π–ª—ã –æ–±—ã—á–Ω–æ —Å—á–∏—Ç–∞—é—Ç—Å—è ¬´–º—É—Å–æ—Ä–æ–º macOS¬ª –Ω–∞ –Ω–µ–º–∞–∫–æ–≤—ã—Ö –§–° –∏ —Å–ø–æ–∫–æ–π–Ω–æ —É–¥–∞–ª—è—é—Ç—Å—è (–∏—Ö —Ä–µ–≥—É–ª—è—Ä–Ω–æ —á–∏—Å—Ç—è—Ç –Ω–∞ Linux/Windows, –∫–æ–≥–¥–∞ —Ñ–ª–µ—à–∫—É —Ç—ã–∫–∞–ª –≤ Mac).

–ú–æ–∂–µ—à—å —É–±–µ–¥–∏—Ç—å—Å—è –∫–æ–º–∞–Ω–¥–æ–π:

```bash
file 202407/.IMG_0035.HEIC
```

–° –±–æ–ª—å—à–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é —É–≤–∏–¥–∏—à—å —á—Ç–æ-—Ç–æ –≤—Ä–æ–¥–µ:

```text
AppleDouble encoded Macintosh file
```

–∏–ª–∏ –ø–æ—Ö–æ–∂–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ.

**–£–¥–∞–ª–∏—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω–æ**:

```bash
rm 202407/.IMG_0035.HEIC
```

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ:

```bash
hashdeep -a -k 202407.sha256.manifest -r -l 202407
# ‚Üí –¥–æ–ª–∂–µ–Ω —Å–Ω–æ–≤–∞ —Å–∫–∞–∑–∞—Ç—å "Audit passed"
```

(–µ—Å–ª–∏ –¥—Ä—É–≥–∏—Ö –æ—Ç–ª–∏—á–∏–π –Ω–µ—Ç).

### 5. –ö–∞–∫ –Ω–µ –ª–æ–≤–∏—Ç—å —Ç–∞–∫–∏–µ —Å—é—Ä–ø—Ä–∏–∑—ã –≤ –±—É–¥—É—â–µ–º

–£ —Ç–µ–±—è —Ç–µ–ø–µ—Ä—å –æ—á–µ–Ω—å —Ö–æ—Ä–æ—à–∏–π, ¬´—á–∏—Å—Ç—ã–π¬ª –ø—Ä–æ—Ü–µ—Å—Å, –∏ –≤–æ—Ç –∫–∞–∫ –µ–≥–æ –Ω–µ–º–Ω–æ–≥–æ –∑–∞–∫–∞–ª–∏—Ç—å:

#### 5.1 –ß–∏—Å—Ç–∏—Ç—å –º–∞–∫–æ–≤—Å–∫–∏–π –º—É—Å–æ—Ä –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞

–í –∫–∞—Ç–∞–ª–æ–≥–µ –º–µ—Å—è—Ü–∞ –ø–µ—Ä–µ–¥ `hashdeep` –º–æ–∂–Ω–æ –ø—Ä–æ–π—Ç–∏—Å—å:

```bash
# —É–¥–∞–ª–∏—Ç—å AppleDouble –∏ –ø–æ—Ö–æ–∂–∏–π –º—É—Å–æ—Ä
find 202407 -type f \( -name '._*' -o -name '.DS_Store' \) -delete
```

–í —Ç–≤–æ—ë–º —Å–ª—É—á–∞–µ `.IMG_0035.HEIC` –±–µ–∑ –ø–æ–¥—á—ë—Ä–∫–∏–≤–∞–Ω–∏—è ‚Äî –∞–Ω–æ–º–∞–ª–∏—è, –µ—ë –º–æ–∂–Ω–æ —É–±—Ä–∞—Ç—å —Ä—É–∫–∞–º–∏.

#### 5.2 –û—Ç–∫–ª—é—á–∏—Ç—å —á–∞—Å—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö macOS –Ω–∞ –∞—Ä—Ö–∏–≤–Ω—ã—Ö –¥–∏—Å–∫–∞—Ö

–ß—Ç–æ–±—ã —Å–∏—Å—Ç–µ–º–∞ –º–µ–Ω—å—à–µ –≥–∞–¥–∏–ª–∞ –Ω–∞ –∞—Ä—Ö–∏–≤–Ω—ã–π –¥–∏—Å–∫:

* –í—ã–∫–ª—é—á–∏—Ç—å Spotlight –Ω–∞ —ç—Ç–æ–º —Ç–æ–º–µ:

  ```bash
  mdutil -i off -d /Volumes/ARCH20TB
  ```

* –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–º –≤ **Spotlight ‚Üí Privacy**.

* (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) —Å–æ–∑–¥–∞—Ç—å –≤ –∫–æ—Ä–Ω–µ –∞—Ä—Ö–∏–≤–∞ —Ñ–∞–π–ª-–º–∞—Ä–∫–µ—Ä:

  ```bash
  sudo touch /Volumes/ARCH20TB/.metadata_never_index
  ```

  –¢–æ–≥–¥–∞ Spotlight –Ω–µ –±—É–¥–µ—Ç –ø—ã—Ç–∞—Ç—å—Å—è –∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–∏ –∫–∞—Ç–∞–ª–æ–≥–∏.

–≠—Ç–æ –Ω–µ —É–±–µ—Ä—ë—Ç –≤—Å–µ AppleDouble-—Ñ–∞–π–ª—ã, –Ω–æ —É–º–µ–Ω—å—à–∏—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª—É–∂–µ–±–Ω–æ–≥–æ –º—É—Å–æ—Ä–∞.

#### 5.3 –ü—Ä–∏–Ω—è—Ç—å –ø—Ä–∞–≤–∏–ª–æ: –º–∞–Ω–∏—Ñ–µ—Å—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç *–∫–æ–Ω—Ç–µ–Ω—Ç*, –∞ –Ω–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ OS

–í —Ç–≤–æ–µ–π –º–æ–¥–µ–ª–∏:

* –≤–∞–∂–Ω—ã **—Ñ–æ—Ç–æ/–≤–∏–¥–µ–æ** (`*.HEIC`, `*.JPG`, `*.MOV` –∏ —Ç.–¥.),
* –Ω–µ –≤–∞–∂–Ω—ã –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ Finder, quarantine –∏ –ø—Ä–æ—á–∏–µ xattr.

–¢–∞–∫ —á—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –µ—Å–ª–∏ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏:

* –ø–µ—Ä–µ–¥ –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞ —á–∏—Å—Ç–∏—à—å `.DS_Store`, `._*` –∏ –ø–æ–¥–æ–±–Ω—ã–µ,
* –∞ –ø–æ—Ç–æ–º —É–∂–µ `hashdeep -r -l -c sha256 202407 > 202407.sha256.manifest`.

---

### 6. –†–µ–∑—é–º–µ –ø–æ —Ç–µ–∫—É—â–µ–π —Å–∏—Ç—É–∞—Ü–∏–∏

1. `Audit failed` —Å–ª—É—á–∏–ª—Å—è –ø–æ—Ç–æ–º—É, —á—Ç–æ –Ω–∞ ARCH20TB –µ—Å—Ç—å **–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª** `202407/.IMG_0035.HEIC`, –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–µ –±—ã–ª–æ –Ω–∞ ZFS, –∏ –ø–æ—ç—Ç–æ–º—É –µ–≥–æ –Ω–µ—Ç –≤ –º–∞–Ω–∏—Ñ–µ—Å—Ç–µ.
2. –≠—Ç–æ—Ç —Ñ–∞–π–ª ‚Äî **–Ω–µ —Ñ–æ—Ç–æ**, –∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö macOS (AppleDouble/xattr: `com.apple.lastuseddate#PS`, `com.apple.quarantine` –∏ —Ç.–ø.).
3. –î–ª—è –¥–æ–º–∞—à–Ω–µ–≥–æ –∞—Ä—Ö–∏–≤–∞ –µ–≥–æ –º–æ–∂–Ω–æ **—Å–º–µ–ª–æ —É–¥–∞–ª–∏—Ç—å**, –≤–º–µ—Å—Ç–µ —Å –¥—Ä—É–≥–∏–º–∏ —Ç–∞–∫–∏–º–∏ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∞–º–∏.
4. –ü–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è –∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ `hashdeep -a -k ...` –∞—É–¥–∏—Ç –¥–æ–ª–∂–µ–Ω —Å–Ω–æ–≤–∞ –ø—Ä–æ—Ö–æ–¥–∏—Ç—å.

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å, –º–æ–∂–µ–º –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–º —à–∞–≥–µ –¥–ª—è –≤—Å–µ–≥–æ –∞—Ä—Ö–∏–≤–∞ –ø—Ä–∏–¥—É–º–∞—Ç—å –º–∞–ª–µ–Ω—å–∫–∏–π ¬´—Å–∞–Ω–∏—Ç–∞–π–∑–µ—Ä¬ª-—Å–∫—Ä–∏–ø—Ç, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å –∏ —É–¥–∞–ª—è—Ç—å —Ç–∞–∫–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ-—Ñ–∞–π–ª—ã –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º –∏–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–æ–π –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞, —á—Ç–æ–±—ã —Ç—ã –≤–æ–æ–±—â–µ –ø—Ä–æ –Ω–∏—Ö –Ω–µ –≤—Å–ø–æ–º–∏–Ω–∞–ª.
